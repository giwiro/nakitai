use std::fs::Metadata;
use walkdir::{DirEntry, WalkDir};

fn is_important_file(file_name: &str) -> bool {
    const COMMON_EXTENSIONS: [&str; 1560] = [
        ".php",
        ".html",
        ".txt",
        ".htm",
        ".aspx",
        ".asp",
        ".js",
        ".css",
        ".pdf",
        ".cgi",
        ".inc",
        ".gif",
        ".jpg",
        ".swf",
        ".xml",
        ".cfm",
        ".xhtml",
        ".wmv",
        ".zip",
        ".axd",
        ".gz",
        ".png",
        ".doc",
        ".shtml",
        ".jsp",
        ".ico",
        ".exe",
        ".csi",
        ".config",
        ".jpeg",
        ".ashx",
        ".log",
        ".xls",
        ".0",
        ".old",
        ".mp3",
        ".com",
        ".tar",
        ".ini",
        ".asa",
        ".tgz",
        ".flv",
        ".php3",
        ".bak",
        ".rar",
        ".asmx",
        ".xlsx",
        ".page",
        ".phtml",
        ".dll",
        ".asax",
        ".1",
        ".msg",
        ".pl",
        ".csv",
        ".2",
        ".3",
        ".ppt",
        ".nsf",
        ".bmp",
        ".sql",
        ".new",
        ".avi",
        ".psd",
        ".rss",
        ".wav",
        ".action",
        ".db",
        ".dat",
        ".do",
        ".xsl",
        ".class",
        ".mdb",
        ".include",
        ".cs",
        ".htc",
        ".mov",
        ".tpl",
        ".4",
        ".12",
        ".9",
        ".mysql-connect",
        ".mpg",
        ".rdf",
        ".rtf",
        ".6",
        ".ascx",
        ".mvc",
        ".files",
        ".master",
        ".jar",
        ".vb",
        ".mp4",
        ".fla",
        ".require",
        ".de",
        ".docx",
        ".php5",
        ".wci",
        ".readme",
        ".7",
        ".cfg",
        ".cfc",
        ".dwt",
        ".ru",
        ".lck",
        ".gif_var_de",
        ".html_var_de",
        ".net",
        ".ttf",
        ".x-aom",
        ".jhtml",
        ".mpeg4",
        ".mpeg",
        ".x-fancycat",
        ".php4",
        ".readme_var_de",
        ".vcf",
        ".x-rma",
        ".x-affiliate",
        ".x-offers",
        ".x-affiliate_var_de",
        ".x-aom_var_de",
        ".x-fancycat_var_de",
        ".x-fcomp",
        ".x-fcomp_var_de",
        ".x-giftreg",
        ".rs",
        ".x-giftreg_var_de",
        ".x-magnifier",
        ".x-magnifier_var_de",
        ".x-offers_var_de",
        ".x-pconf",
        ".x-pconf_var_de",
        ".x-rma_var_de",
        ".x-survey",
        ".tif",
        ".dir",
        ".json",
        ".zif",
        ".wma",
        ".8",
        ".mid",
        ".rm",
        ".woa",
        ".main",
        ".ram",
        ".opml",
        ".feed",
        ".lasso",
        ".shtm",
        ".sitemap",
        ".scc",
        ".tmp",
        ".backup",
        ".sln",
        ".org",
        ".conf",
        ".mysql-query",
        ".session-start",
        ".uk",
        ".10",
        ".14",
        ".orig",
        ".19",
        ".cab",
        ".kml",
        ".pps",
        ".require-once",
        ".asx",
        ".bok",
        ".msi",
        ".01",
        ".c",
        ".fcgi",
        ".fopen",
        ".bin",
        ".htaccess",
        ".info",
        ".java",
        ".jsf",
        ".tmpl",
        ".00",
        ".bat",
        ".print",
        ".resx",
        ".ics",
        ".x",
        ".data",
        ".dcr",
        ".enfinity",
        ".licx",
        ".mno",
        ".plx",
        ".vm",
        ".11",
        ".50",
        ".dwg",
        ".edu",
        ".search",
        ".static",
        ".wws",
        ".bz2",
        ".ece",
        ".epc",
        ".getimagesize",
        ".ice",
        ".3gp",
        ".it_backup_giornaliero",
        ".it_backup_settimanale",
        ".jspa",
        ".lst",
        ".php-dist",
        ".svc",
        ".vbs",
        ".30-i486",
        ".ai",
        ".cur",
        ".dmg",
        ".img",
        ".inf",
        ".seam",
        ".1a",
        ".34",
        ".7z",
        ".ajax",
        ".chm",
        ".csp",
        ".edit",
        ".file",
        ".m3u",
        ".psp",
        ".py",
        ".sh",
        ".test",
        ".zdat",
        ".04",
        ".admin",
        ".dev",
        ".eps",
        ".file-get-contents",
        ".fr",
        ".fsockopen",
        ".list",
        ".m4v",
        ".p",
        ".store",
        ".webinfo",
        ".1c",
        ".300",
        ".790",
        ".826",
        ".bk",
        ".bsp",
        ".cms",
        ".d",
        ".html,",
        ".htmll",
        ".idx",
        ".images",
        ".jad",
        ".prev_next",
        ".ssf",
        ".stm",
        ".8169",
        ".4511",
        ".112",
        ".134",
        ".156",
        ".21",
        ".24",
        ".969",
        ".as",
        ".au",
        ".cnf",
        ".dhtml",
        ".enu",
        ".include-once",
        ".lock",
        ".m",
        ".mysql-select-db",
        ".phps",
        ".pm",
        ".pptx",
        ".sav",
        ".sendtoafriendform",
        ".ssi",
        ".suo",
        ".vbproj",
        ".wml",
        ".xsd",
        ".array-keys",
        ".atom",
        ".award",
        ".bkp",
        ".crt",
        ".default",
        ".eml",
        ".epl",
        ".fancybox",
        ".fil",
        ".geo",
        ".h",
        ".hmtl",
        ".ida",
        ".implode",
        ".iso",
        ".kmz",
        ".mysql-pconnect",
        ".rec",
        ".storefront",
        ".taf",
        ".war",
        ".xslt",
        ".15",
        ".23",
        ".2a",
        ".sponsors",
        ".a",
        ".aquery",
        ".cat",
        ".contrib",
        ".ds",
        ".dwf",
        ".film",
        ".g",
        ".go",
        ".googlebook",
        ".gpx",
        ".hotelname",
        ".ihtml",
        ".in-array",
        ".index",
        ".layer",
        ".maninfo",
        ".odt",
        ".price",
        ".randomhouse",
        ".read",
        ".s7",
        ".sample",
        ".sit",
        ".src",
        ".trck",
        ".uguide",
        ".vorteil",
        ".wbp",
        ".30",
        ".btr",
        ".cer",
        ".html‎",
        ".jbf",
        ".lbi",
        ".lnk",
        ".login",
        ".mhtml",
        ".mpl",
        ".mso",
        ".mysql-result",
        ".original",
        ".pgp",
        ".ph",
        ".preview",
        ".site",
        ".text",
        ".view",
        ".72",
        ".web",
        ".action2",
        ".asc",
        ".browse",
        ".code",
        ".com_backup_giornaliero",
        ".com_backup_settimanale",
        ".csproj",
        ".dtd",
        ".ep",
        ".eu",
        ".form",
        ".html1",
        ".it",
        ".nl",
        ".ogg",
        ".old2",
        ".opendir",
        ".out",
        ".pgt",
        ".php,",
        ".php‎",
        ".po",
        ".prt",
        ".query",
        ".rb",
        ".rhtml",
        ".save",
        ".t",
        ".wsdl",
        ".templates",
        ".adp",
        ".apsx",
        ".asf",
        ".bck",
        ".bu",
        ".calendar",
        ".captcha",
        ".cart",
        ".core",
        ".dot",
        ".egov",
        ".eot",
        ".errors",
        ".f4v",
        ".git",
        ".ht",
        ".hta",
        ".printable",
        ".lib",
        ".lic",
        ".map",
        ".mi",
        ".mkdir",
        ".o",
        ".p7b",
        ".pac",
        ".pd",
        ".pfx",
        ".php2",
        ".php_files",
        ".phtm",
        ".portal",
        ".psql",
        ".pub",
        ".q",
        ".ra",
        ".reg",
        ".rpm",
        ".strpos",
        ".tcl",
        ".template",
        ".tiff",
        ".tv",
        ".us",
        ".user",
        ".06",
        ".09",
        ".25",
        ".5",
        ".controls",
        ".acgi",
        ".alt",
        ".array-merge",
        ".back",
        ".call-user-func-array",
        ".cfml",
        ".cmd",
        ".detail",
        ".disabled",
        ".djvu",
        ".dta",
        ".e",
        ".extract",
        ".file-put-contents",
        ".fpl",
        ".framework",
        ".fread",
        ".includes",
        ".jp",
        ".l",
        ".letter",
        ".local",
        ".num",
        ".pem",
        ".php}",
        ".php~",
        ".pot",
        ".preg-match",
        ".process",
        ".ps",
        ".r",
        ".raw",
        ".rc",
        ".s",
        ".server",
        ".sis",
        ".squery",
        ".subscribe",
        ".svg",
        ".svn",
        ".thtml",
        ".ua",
        ".vcs",
        ".xhtm",
        ".xpi",
        ".07",
        ".08",
        ".17",
        ".2008",
        ".2011",
        ".22",
        ".2ms2",
        ".32",
        ".33",
        ".91",
        ".add",
        ".array-rand",
        ".aspx,",
        ".awm",
        ".b",
        ".bhtml",
        ".bml",
        ".ca",
        ".cache",
        ".cn",
        ".cz",
        ".diff",
        ".email",
        ".en",
        ".error",
        ".faces",
        ".filesize",
        ".hml",
        ".hqx",
        ".html,404",
        ".htmls",
        ".htx",
        ".i",
        ".idq",
        ".jpe",
        ".jspf",
        ".load",
        ".media",
        ".mp2",
        ".mspx",
        ".mv",
        ".mysql",
        ".ocx",
        ".oui",
        ".outcontrol",
        ".pad",
        ".pages",
        ".pdb",
        ".pnp",
        ".pop_formata_viewer",
        ".pvk",
        ".results",
        ".run",
        ".scripts",
        ".sdb",
        ".ser",
        ".shop",
        ".smi",
        ".start",
        ".ste",
        ".textsearch",
        ".torrent",
        ".unsubscribe",
        ".v",
        ".wmf",
        ".wpd",
        ".ws",
        ".xpml",
        ".y",
        ".adcode",
        ".getmapimage",
        ".skins",
        ".z",
        ".app",
        ".asd",
        ".asm",
        ".assets",
        ".at",
        ".bad",
        ".bak2",
        ".blog",
        ".casino",
        ".cc",
        ".cdr",
        ".children",
        ".com,",
        ".com-redirect",
        ".content",
        ".copy",
        ".count",
        ".cp",
        ".custom",
        ".dbf",
        ".deb",
        ".delete",
        ".dic",
        ".divx",
        ".download",
        ".epub",
        ".err",
        ".es",
        ".exclude",
        ".filemtime",
        ".grp",
        ".home",
        ".htlm",
        ".htm,",
        ".html-",
        ".image",
        ".j",
        ".jnlp",
        ".js2",
        ".jspx",
        ".link",
        ".listevents",
        ".mbox",
        ".mc_id",
        ".mgi",
        ".mod",
        ".news",
        ".none",
        ".off",
        ".p3p",
        ".php1",
        ".phpp",
        ".pop_3d_viewer",
        ".prep",
        ".prg",
        ".product_details",
        ".pwd",
        ".pyc",
        ".red",
        ".registration",
        ".se",
        ".sea",
        ".sema",
        ".session",
        ".setup",
        ".simplexml-load-file",
        ".sitx",
        ".smil",
        ".srv",
        ".swi",
        ".swp",
        ".sxw",
        ".tem",
        ".temp",
        ".top",
        ".types",
        ".unlink",
        ".url",
        ".vspscc",
        ".vssscc",
        ".w",
        ".work",
        ".wvx",
        ".xspf",
        ".-",
        ".0-rc1",
        ".000",
        ".002",
        ".02",
        ".030-i486",
        ".05",
        ".1-pt_br",
        ".2010",
        ".131",
        ".132",
        ".2-rc1",
        ".2004",
        ".2006",
        ".2009",
        ".26",
        ".27",
        ".31",
        ".35",
        ".7-pl1",
        ".6-all-languages",
        ".16",
        ".18",
        ".64",
        ".65",
        ".66",
        ".762",
        ".808",
        ".85",
        ".90",
        ".92",
        ".972",
        ".engineer",
        ".maximize",
        ".ndm",
        ".sim",
        ".services",
        ".[file",
        ".accdb",
        ".act",
        ".ads",
        ".alhtm",
        ".all",
        ".ani",
        ".apf",
        ".apj",
        ".ar",
        ".arc",
        ".array-key-exists",
        ".asp1",
        ".aspg",
        ".bfhtm",
        ".biminifinder",
        ".br",
        ".browser",
        ".build",
        ".buscar",
        ".categorias",
        ".categories",
        ".ccs",
        ".ch",
        ".cl",
        ".cls",
        ".common",
        ".control",
        ".coverfinder",
        ".cs2",
        ".d2w",
        ".dbm",
        ".dct",
        ".dmb",
        ".dxf",
        ".ed",
        ".engine",
        ".env",
        ".error-log",
        ".esp",
        ".ex",
        ".exc",
        ".exe,",
        ".ext",
        ".external",
        ".ficheros",
        ".fichiers",
        ".flush",
        ".fmt",
        ".fn",
        ".footer",
        ".form_jhtml",
        ".friend",
        ".ghtml",
        ".gov",
        ".gpg",
        ".hl",
        ".href",
        ".htm2",
        ".html[",
        ".html]",
        ".html_",
        ".html_files",
        ".htmlpar",
        ".htmlprint",
        ".html}",
        ".htm~",
        ".hts",
        ".hu",
        ".hwp",
        ".ibf",
        ".il",
        ".imagecreatetruecolor",
        ".imagejpeg",
        ".iml",
        ".imprimer",
        ".imprimer-cadre",
        ".imprimir",
        ".imprimir-marco",
        ".inl",
        ".inv",
        ".join",
        ".jps",
        ".key",
        ".kit",
        ".lang",
        ".lignee",
        ".ltr",
        ".lzh",
        ".m4a",
        ".mail",
        ".manager",
        ".md5",
        ".met",
        ".metadesc",
        ".metakeys",
        ".mht",
        ".min",
        ".mld",
        ".mobi",
        ".mobile",
        ".mv4",
        ".n",
        ".nfo",
        ".nikon",
        ".nodos",
        ".nxg",
        ".obyx",
        ".ods",
        ".open",
        ".ord",
        ".ori",
        ".partfinder",
        ".pho",
        ".php-",
        ".phpl",
        ".phpx",
        ".pix",
        ".pls",
        ".prc",
        ".pre",
        ".prhtm",
        ".print-frame",
        ".printer",
        ".properties",
        ".propfinder",
        ".pvx",
        ".p​hp",
        ".recherche",
        ".redirect",
        ".req",
        ".safe",
        ".sbk",
        ".sec",
        ".seo",
        ".serv",
        ".servlet",
        ".settings",
        ".sf",
        ".show",
        ".sht",
        ".so",
        ".sph",
        ".split",
        ".sso",
        ".story",
        ".swd",
        ".sys",
        ".tex",
        ".tga",
        ".thm",
        ".tlp",
        ".tml",
        ".touch",
        ".tsv",
        ".ug",
        ".unternehmen",
        ".utf8",
        ".vsprintf",
        ".vstemplate",
        ".vtl",
        ".wbmp",
        ".webc",
        ".webproj",
        ".wihtm",
        ".wp",
        ".wps",
        ".wri",
        ".wsc",
        ".www",
        ".xsp",
        ".xsql",
        ".zip,",
        ".zml",
        ".ztml",
        ". extrahotelero hospedaje",
        ". php",
        ".,",
        ".-bouncing",
        ".-safety-fear",
        ".0-pl1",
        ".11-pr1",
        ".006",
        ".01-10",
        ".011",
        ".017",
        ".041",
        ".052",
        ".062007",
        ".070425",
        ".08-2009",
        ".0b",
        ".1-en",
        ".1-english",
        ".1-rc1",
        ".9498",
        ".1008",
        ".105",
        ".1052",
        ".10a",
        ".5-all-languages-utf-8-only",
        ".110607",
        ".1132",
        ".1274",
        ".12d6",
        ".12ea",
        ".133",
        ".139",
        ".13ba",
        ".13f8",
        ".1478",
        ".1514",
        ".articlepk",
        ".15f4",
        ".160",
        ".161e",
        ".16be",
        ".1726",
        ".175",
        ".17cc",
        ".180",
        ".1808",
        ".1810",
        ".1832",
        ".185",
        ".18a",
        ".191e",
        ".1958",
        ".1994",
        ".199c",
        ".1ade",
        ".1c2e",
        ".1c50",
        ".1cd6",
        ".1d8c",
        ".1e0",
        ".1_stable",
        ".2-english",
        ".2005",
        ".202",
        ".20a6",
        ".220",
        ".125",
        ".24stable",
        ".25ce",
        ".2769",
        ".2808",
        ".29",
        ".2abe",
        ".2b26",
        ".2cc",
        ".2cd0",
        ".2d1a",
        ".2de",
        ".2e4",
        ".2e98",
        ".2ee2",
        ".2b",
        ".3-pl1",
        ".3-rc1",
        ".7-english",
        ".308e",
        ".330",
        ".3374",
        ".33e0",
        ".346a",
        ".347a",
        ".347c",
        ".3500",
        ".3590",
        ".35b8",
        ".36",
        ".37",
        ".37c2",
        ".3850",
        ".3ea",
        ".3f54",
        ".4-all-languages",
        ".4040",
        ".414",
        ".41a2",
        ".4234",
        ".42ba",
        ".43",
        ".43ca",
        ".43fa",
        ".4522",
        ".4556",
        ".464",
        ".46a2",
        ".46d4",
        ".47f6",
        ".482623",
        ".4884",
        ".490",
        ".497c",
        ".4a4",
        ".4a84",
        ".4b88",
        ".4c6",
        ".4cc",
        ".4d3c",
        ".4d6c",
        ".4fb8",
        ".5-pl1",
        ".508",
        ".50a",
        ".51",
        ".5214",
        ".574",
        ".576",
        ".5b0",
        ".5e0",
        ".5e5e",
        ".5_mod_for_host",
        ".608",
        ".63",
        ".acquisition",
        ".appraisal",
        ".b04",
        ".b18",
        ".b1c",
        ".commerce",
        ".corelproject",
        ".d20",
        ".d7a",
        ".dc2",
        ".direct",
        ".dnnwebservice",
        ".e46",
        ".e96",
        ".ea0",
        ".eba",
        ".ec0",
        ".ede",
        ".eea",
        ".ef8",
        ".eus",
        ".f22",
        ".f46",
        ".f54",
        ".fae",
        ".frk",
        ".kb",
        ".lassoapp",
        ".newconfigpossiblybroken",
        ".publish",
        ".sidemenu",
        ".wtc",
        ".xmlhttp",
        "._order",
        ".a5w",
        ".aac",
        ".access",
        ".actions",
        ".adm",
        ".advsearch",
        ".aj_",
        ".hawaii",
        ".ap",
        ".api",
        ".apk",
        ".application",
        ".archiv",
        ".arj",
        ".array-map",
        ".array-values",
        ".art",
        ".artdeco",
        ".asp-",
        ".asp2",
        ".aspdonotuse",
        ".asp_",
        ".asp_files",
        ".aspl",
        ".aspp",
        ".asps",
        ".aspx_files",
        ".aspxx",
        ".aspy",
        ".asxp",
        ".as​p",
        ".awstats",
        ".a​sp",
        ".barnes",
        ".baut",
        ".bc",
        ".beta",
        ".biz",
        ".boom",
        ".buyadspace",
        ".bycategory",
        ".bylocation",
        ".bz",
        ".car",
        ".catalog",
        ".cdf",
        ".ce",
        ".cfswf",
        ".cfx",
        ".cgis",
        ".chat",
        ".chdir",
        ".cmp",
        ".cnt",
        ".co",
        ".com_backup_",
        ".com_files",
        ".comments",
        ".console",
        ".contact",
        ".controller",
        ".corp",
        ".cqs",
        ".cron",
        ".crx",
        ".csr",
        ".cssd",
        ".ctp",
        ".cx",
        ".d64",
        ".daisy",
        ".dal",
        ".daniel",
        ".data_",
        ".davis",
        ".dbml",
        ".dcf",
        ".del",
        ".deleted",
        ".dell",
        ".demo",
        ".nz",
        ".development",
        ".dig",
        ".dist",
        ".dk",
        ".dm",
        ".dms",
        ".dnn",
        ".dogpl",
        ".dontcopy",
        ".du",
        ".dump",
        ".dws",
        ".dyn",
        ".ebay",
        ".ehtml",
        ".enn",
        ".eur",
        ".exec",
        ".exp",
        ".faucetdepot",
        ".fb2",
        ".fdml",
        ".ffa",
        ".filereader",
        ".flac",
        ".flypage",
        ".fon",
        ".pass",
        ".forms",
        ".forum",
        ".found",
        ".fp7",
        ".ft",
        ".ftl",
        ".garcia",
        ".gb",
        ".get",
        ".get-meta-tags",
        ".za",
        ".google",
        ".gray",
        ".gsp",
        ".tk",
        ".gutschein",
        ".guy",
        ".ha",
        ".henry",
        ".him",
        ".history",
        ".hlr",
        ".hm",
        ".ho",
        ".hokkaido",
        ".hold",
        ".homepage",
        ".hp",
        ".htm3",
        ".htm5",
        ".htm7",
        ".htm8",
        ".htm_",
        ".html,,",
        ".html-0",
        ".html-1",
        ".html-c",
        ".html-old",
        ".html-p",
        ".html4",
        ".html5",
        ".html7",
        ".htmlbak",
        ".htmldolmetschen",
        ".html_old",
        ".htmla",
        ".htmlc",
        ".htmlfeed",
        ".htmlq",
        ".htmlu",
        ".htn",
        ".htpasswd",
        ".h​tml",
        ".iconv",
        ".idf",
        ".iframe_filtros",
        ".ihmtl",
        ".ihya",
        ".imp",
        ".in",
        ".inactive",
        ".incl",
        ".indt",
        ".insert",
        ".ipl",
        ".issues",
        ".itml",
        ".ixi",
        ".jhtm",
        ".job",
        ".joseph",
        ".jpf",
        ".jpg[",
        ".jpg]",
        ".js,",
        ".jsa",
        ".jsd",
        ".jso",
        ".jsps",
        ".jtp",
        ".keyword",
        ".kk",
        ".kokuken",
        ".ks",
        ".net-en",
        ".last",
        ".latest",
        ".lha",
        ".links",
        ".listminigrid",
        ".listing",
        ".lng",
        ".loc",
        ".log2",
        ".lua",
        ".lynkx",
        ".mag",
        ".mbizgroup",
        ".mel",
        ".members",
        ".midi",
        ".min_",
        ".rabattlp",
        ".mkv",
        ".mmap",
        ".mp",
        ".mq4",
        ".msp",
        ".mvn",
        ".mysqli",
        ".napravlenie_asc",
        ".napravlenie_desc",
        ".nded-pga-emial",
        ".net_backup_giornaliero",
        ".net_backup_settimanale",
        ".newsletter",
        ".nth",
        ".od",
        ".offline",
        ".ogv",
        ".ok",
        ".old1",
        ".old3",
        ".older",
        ".oliver",
        ".online",
        ".opensearch",
        ".osg",
        ".outbound",
        ".owen",
        ".pae",
        ".page_pls_all_password",
        ".pan",
        ".parse-url",
        ".part",
        ".patch",
        ".paul",
        ".pdd",
        ".pdfx",
        ".phdo",
        ".photo",
        ".php_",
        ".php_old",
        ".phphp",
        ".phppar",
        ".pht",
        ".plugins",
        ".png,bmp",
        ".popup",
        ".prev",
        ".prl",
        ".psb",
        ".qtgp",
        ".qxd",
        ".rails",
        ".readfile",
        ".remove",
        ".removed",
        ".resultados",
        ".resume",
        ".rhtm",
        ".rmvb",
        ".ro",
        ".roma",
        ".rpt",
        ".rsp",
        ".rss_cars",
        ".rss_homes",
        ".rss_jobs",
        ".rtfd",
        ".rvt",
        ".safariextz",
        ".sc",
        ".scandir",
        ".section",
        ".secure",
        ".send",
        ".sent-",
        ".service",
        ".session-regenerate-id",
        ".set",
        ".sfw",
        ".sgf",
        ".sidebar",
        ".sisx",
        ".skin",
        ".sort",
        ".sp",
        ".sphp3",
        ".srch",
        ".srf",
        ".srvl",
        ".sta",
        ".staging",
        ".stat",
        ".stats",
        ".step",
        ".stml",
        ".suarez",
        ".submit",
        ".support",
        ".sym",
        ".system",
        ".tab-",
        ".tb",
        ".tech",
        ".tf",
        ".tg",
        ".thanks",
        ".theme",
        ".thompson",
        ".tim",
        ".tls",
        ".to",
        ".trace",
        ".trade",
        ".ts",
        ".tst",
        ".tvpi",
        ".ufo",
        ".update",
        ".upgrade",
        ".var",
        ".verify",
        ".video",
        ".viewpage__10",
        ".vmdk",
        ".vn",
        ".vs",
        ".vx",
        ".vxlpub",
        ".w3m",
        ".w3x",
        ".wax",
        ".webalizer",
        ".webarchive",
        ".webm",
        ".wgx",
        ".wireless",
        ".wm",
        ".working",
        ".wpl",
        ".wplus",
        ".xconf",
        ".xgi",
        ".xhtml5",
        ".xlt",
        ".xm",
        ".xpdf",
        ".xqy",
        ".xslx",
        ".xst",
        ".xsx",
        ".yp",
        ".ys",
        ".zhtml",
        ".d3dbsp",
        ".sc2save",
        ".sie",
        ".sum",
        ".docm",
        ".ibank",
        ".t13",
        ".t12",
        ".qdf",
        ".gdb",
        ".tax",
        ".pkpass",
        ".bc6",
        ".bc7",
        ".qic",
        ".bkf",
        ".sidn",
        ".sidd",
        ".mddata",
        ".itl",
        ".itdb",
        ".icxs",
        ".hvpl",
        ".hplg",
        ".hkdb",
        ".mdbackup",
        ".syncdb",
        ".gho",
        ".cas",
        ".wmo",
        ".itm",
        ".sb",
        ".fos",
        ".vdf",
        ".ztmp",
        ".sid",
        ".ncf",
        ".menu",
        ".layout",
        ".dmp",
        ".blob",
        ".esm",
        ".vtf",
        ".dazip",
        ".fpk",
        ".mlx",
        ".kf",
        ".iwd",
        ".vpk",
        ".tor",
        ".psk",
        ".rim",
        ".fsh",
        ".ntl",
        ".arch00",
        ".lvl",
        ".snx",
        ".cfr",
        ".ff",
        ".vpp_pc",
        ".lrf",
        ".m2",
        ".mcmeta",
        ".vfs0",
        ".mpqge",
        ".kdb",
        ".db0",
        ".dba",
        ".rofl",
        ".hkx",
        ".bar",
        ".upk",
        ".das",
        ".iwi",
        ".litemod",
        ".asset",
        ".forge",
        ".ltx",
        ".bsa",
        ".re4",
        ".lbf",
        ".slm",
        ".bik",
        ".epk",
        ".rgss3a",
        ".pak",
        ".big",
        ".wallet",
        ".wotreplay",
        ".xxx",
        ".desc",
        ".p7c",
        ".pk7",
        ".p12",
        ".der",
        ".x3f",
        ".srw",
        ".pef",
        ".ptx",
        ".r3d",
        ".rw2",
        ".rwl",
        ".raf",
        ".orf",
        ".nrw",
        ".mrwref",
        ".mef",
        ".erf",
        ".kdc",
        ".cr2",
        ".crw",
        ".bay",
        ".sr2",
        ".arw",
        ".3fr",
        ".dng",
        ".indd",
        ".mdf",
        ".wb2",
        ".dxg",
        ".xf",
        ".pst",
        ".pptm",
        ".xlk",
        ".xlsb",
        ".xlsm",
        ".odb",
        ".odc",
        ".odm",
        ".odp",
        ".sqlitedb",
        ".sass",
        ".scss",
        ".less",
        ".webp",
        "config",
        "description",
        "head",
        "exclude",
        "known_hosts",
        "id_rsa",
        "google_compute_engine",
        "google_compute_known_hosts",
        "rc",
        ".yaml",
        ".yml",
        "ignore",
        ".md",
        "env",
        "dockerfile",
        "modules",
        ".toml",
        ".rst",
        ".keep",
        "makefile",
        ".mako",
    ];

    COMMON_EXTENSIONS
        .iter()
        .any(|&suffix| file_name.ends_with(suffix))
}

fn traverse_dir(dir_path: &str, f: impl Fn(DirEntry, Metadata)) {
    for entry in WalkDir::new(dir_path)
        .follow_links(false)
        .into_iter()
        .filter_map(|e| e.ok())
        .filter(|e| {
            !e.path()
                .display()
                .to_string()
                .to_lowercase()
                .contains("node_modules")
        })
    {
        match entry.metadata() {
            Ok(metadata) => f(entry, metadata),
            _ => {}
        }
    }
}

pub fn find_common_files(dir_path: &str, f: impl Fn(DirEntry, Metadata)) {
    traverse_dir(dir_path, |entry, metadata| {
        let file_name = entry.file_name().to_str();

        match file_name {
            Some(name) => {
                if metadata.is_file()
                    && !name.to_lowercase().ends_with(".nakitai")
                    && is_important_file(&name.to_lowercase())
                {
                    f(entry, metadata);
                }
            }
            _ => {}
        }
    });
}

pub fn find_encrypted_files(dir_path: &str, f: impl Fn(DirEntry, Metadata)) {
    traverse_dir(dir_path, |entry, metadata| {
        let file_name = entry.file_name().to_str();

        match file_name {
            Some(name) => {
                if metadata.is_file() && name.to_lowercase().ends_with(".nakitai") {
                    f(entry, metadata);
                }
            }
            _ => {}
        }
    });
}
